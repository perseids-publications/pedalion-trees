/*
 * Arethusa - a backend-independent client-side annotation framework
 * http://github.com/alpheios-project/arethusa
 *
 * Version 0.2.5
 * built from branch HEAD
 * at 952ce617456676bbbac7a486b01b148463e8d959
 * on 2020-05-13T12:28:02.105Z
 *
 * Published under the MIT license
 */

angular.module("arethusa.util",[]);var arethusaUtil={formatNumber:function(a,b){var c=parseInt(a,10);if(isNaN(c))return a;for(var d=""+c;d.length<b;)d="0"+d;return d},formatKeyHint:function(a){return a?"("+a+")":""},map:function(a,b,c){if("object"==typeof b){var d=b;b=function(a){return d[a]}}if("string"==typeof b){var e=b;b=function(a){return a[e]}}var f=[];return a.forEach(function(a){if(c){var d=[a];d.push(c.slice(0)),f.push(b.apply(null,d))}else f.push(b(a))}),f},inject:function(a,b,c){if(arethusaUtil.isArray(b))b.forEach(function(b){c(a,b)});else for(var d in b)c(a,d,b[d]);return a},flatten:function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];(d||!1===d)&&b.push(d)}return b},pushAll:function(a,b){return a.push.apply(a,b),a},findObj:function(a,b){for(var c in a)if(a.hasOwnProperty(c)){var d=a[c];if(b(d))return d}},findNestedProperties:function(a,b){var c=arethusaUtil.toAry(b);return arethusaUtil.inject({},c,function(b,c){var d=function(a,b){var c=[];a.hasOwnProperty(b)&&c.push(a);for(var e in a){var f=a[e];"object"==typeof f&&(f=d(f,b))&&arethusaUtil.pushAll(c,f)}return c};b[c]=d(a,c)})},isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)},toAry:function(a){return a?arethusaUtil.isArray(a)?a:[a]:[]},intersect:function(a,b){function c(a){return arethusaUtil.isIncluded(b,a)}var d;return a.length<b.length&&(d=b,b=a,a=d),a.filter(c)},isIncluded:function(a,b){return-1!==a.indexOf(b)},empty:function(a){if(arethusaUtil.isArray(a))a.splice(0,a.length);else for(var b in a)a.hasOwnProperty(b)&&delete a[b]},last:function(a){return a[a.length-1]},replaceAt:function(a,b,c){return a.substring(0,b)+c+a.substring(b+1)},isTerminatingPunctuation:function(a){return a.match(/^[\.;:]$/)},xmlParser:new X2JS,xml2json:function(a){return arethusaUtil.xmlParser.xml_str2json(a)},json2xml:function(a){return arethusaUtil.xmlParser.json2xml_str(a)},formatXml:function(a){var b,c="",d="",e=/(>)(<)(\/*)/g;a=a.toString().replace(e,"$1\r\n$2$3");var f=0,g=a.split("\r\n");for(var h in g){var i=g[h],j=0;i.match(/.+<\/\w[^>]*>$/)?j=0:i.match(/^<\/\w/)?0!==f&&(f-=1):j=i.match(/^<\w[^>]*[^\/]>.*$/)?1:0;for(var k="",l=0;l<f;l++)k+="  ";b=!1;var m=i.match(/<\/(\w*)>/,"$1");if(m){var n=m[1],o=new RegExp("<"+n);d.match(o)&&(c=c.substring(0,c.length-3)+"/>\r\n",b=!0)}b||(c+=k+i+"\r\n"),d=i,f+=j}return c},getProperty:function(a,b){for(var c=b.split("."),d=0;d<c.length&&(a=a[c[d]]);d++);return a},setProperty:function(a,b,c){for(var d=b.split("."),e=d.pop(),f=0;f<d.length;f++){var g=d[f],h=a[g];a=h||(a[g]={})}a[e]=c},copySelection:function(a,b){var c;return arethusaUtil.inject({},b,function(b,d){c=arethusaUtil.getProperty(a,d),angular.isObject(c)&&(c=angular.copy(c)),arethusaUtil.setProperty(b,d,c)})},percentToRgb:function(a,b){var c,d,e=Math.floor(120*(100-a)/100),f=b||1,g=1,h=[];switch(e/=60,d=Math.floor(e),h=[g*(1-f),g*(1-f*(e-d)),g*(1-f*(1-(e-d)))],d){case 0:c=[g,h[2],h[0]];break;case 1:c=[h[1],g,h[0]];break;case 2:c=[h[0],g,h[2]];break;case 3:c=[h[0],h[1],g];break;case 4:c=[h[2],h[0],g];break;default:c=[g,h[0],h[1]]}return"#"+c.map(function(a){return("0"+Math.round(255*a).toString(16)).slice(-2)}).join("")},toPercent:function(a,b){return b/a*100},resolveFn:function(a){return function(){a.resolve()}},rejectFn:function(a){return function(){a.reject()}},isArethusaMainApplication:function(){var a=document.querySelector("html").attributes["ng-app"];return a&&"arethusa"==a.value},isUrl:function(a){return a.match(/^https?:\/\//)},capitalize:function(a){return a[0].toUpperCase()+a.slice(1)},find:function(a,b){for(var c,d=0;d<a.length;d++){var e=a[d];if(b(e)){c=e;break}}return c},unique:function(a,b){for(var c=[],d=0;d<a.length;d++){for(var e=a[d],f=!0,g=a.length-1;g>=d+1;g--){if(b(e,a[g])){f=!1;break}}f&&c.push(e)}return c}},aU=arethusaUtil;angular.module("arethusa.util").service("commons",[function(){function a(a,b,c){this.label=a,this.model=b,angular.isFunction(c)?this.change=c:this.directive=c}function b(a,b,c){this.xml=a,this.json=b,this.conf=c}function c(a,b,c){var d=this;this.tokens=a,this.cite=b||"",this.subdoc=c||"",this.toString=function(){return arethusaUtil.inject([],d.tokens,function(a,b,c){a.push(c.string)}).join(" ")}}function d(a,b,c,d,e){this.class=a,this.role=b,this.id=c,this.sentenceId=d,this.parent=e,this.isConstituent=!0}function e(a,b){this.string=a,this.sentenceId=b,this.isToken=!0}this.setting=function(b,c,d){return new a(b,c,d)},this.doc=function(a,c,d){return new b(a,c,d)},this.sentence=function(a,b,d){return new c(a,b,d)},this.constituent=function(a,b,c,e,f){return new d(a,b,c,e,f)},this.token=function(a,b){return new e(a,b)}}]),angular.module("arethusa.util").service("generator",[function(){this.panelTrigger=function(a){return{restrict:"A",compile:function(b){function c(a){var c=a();d&&(c+=" ("+d+")"),b.attr("title",c)}var d;return function(b,e,f){function g(){e.toggleClass("on"),a.service.toggle()}function h(){b.$$phase?g():b.$apply(g)}if(a.trsl(a.trslKey,c),e.bind("click",h),a.kC){var i=a.kC.initCaptures(function(b){var c={};return c[a.mapping.name]=[b.create("toggle",function(){h()},a.mapping.key)],c});d=i[a.mapping.name].toggle}}},template:a.template}},this.historyTrigger=function(a,b,c,d){return d=d||c,{restrict:"A",scope:{},link:function(d,e,f){function g(){e.attr("title",h+" "+i)}d.history=a,d.$watch("history.mode",function(a,b){"editor"===a?e.show():e.hide()}),d.$watch("history.can"+aU.capitalize(c),function(a,b){a?e.removeClass("disabled"):e.addClass("disabled")}),e.bind("click",function(){d.$apply(a[c]())});var h,i;d.$watch("history.activeKeys."+c,function(a){a&&(i=aU.formatKeyHint(a),g())}),b("history."+c,function(a){h=a(),g()})},template:'<i class="fa fa-'+d+'"/>'}}}]),angular.module("arethusa.util").service("logger",[function(){this.log=function(a){console.log(a)}}]);
//# sourceMappingURL=arethusa.util.min.map